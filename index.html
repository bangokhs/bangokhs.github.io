<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í™•ë¥  ê¸°ë°˜ ìŠ¬ë¡¯ë¨¸ì‹ </title>
    <style>
        /* CSS: ì‹¤ì œ ìŠ¬ë¡¯ë¨¸ì‹  í…Œë§ˆ ë””ìì¸ ì ìš© */
        body {
            font-family: 'Malgun Gothic', 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-color: #ffffff; /* 1. ë°°ê²½ìƒ‰ì„ í°ìƒ‰ìœ¼ë¡œ ë³€ê²½ */
            padding: 20px;
        }
        .game-frame { /* ìŠ¬ë¡¯ë¨¸ì‹  ë³¸ì²´ ë””ìì¸ */
            padding: 30px;
            background-color: #8B0000; /* ì§™ì€ ë¹¨ê°„ìƒ‰ (ì¹´ì§€ë…¸ í…Œë§ˆ) */
            border: 10px solid #FFD700; /* ê¸ˆìƒ‰ í…Œë‘ë¦¬ */
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 400px;
        }
        h1 {
            color: #FFD700; /* ê¸ˆìƒ‰ ì œëª© */
            text-shadow: 2px 2px 4px #000;
        }
        .balance-box {
            margin-bottom: 20px;
            font-size: 20px;
            font-weight: bold;
            color: #000;
            padding: 10px 20px;
            border: 3px solid #000;
            border-radius: 5px;
            background-color: #7CFC00; /* ì´ˆë¡ìƒ‰ LED ë””ìŠ¤í”Œë ˆì´ ëŠë‚Œ */
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
            min-width: 300px;
            text-align: center;
        }
        .slot-container {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }
        .reel { /* ë¦´ ë””ìì¸ */
            font-size: 60px; 
            width: 100px;
            height: 100px;
            line-height: 100px;
            text-align: center;
            border: 6px solid #C0C0C0; /* ì€ìƒ‰(ì‹¤ë²„) ê¸ˆì† í…Œë‘ë¦¬ */
            border-radius: 10px;
            background-color: #333; /* ì‹¬ë³¼ ë°°ê²½ì€ ì–´ë‘ìš´ìƒ‰ */
            color: #fff; /* ì‹¬ë³¼ ìƒ‰ìƒì€ í°ìƒ‰ìœ¼ë¡œ ëŒ€ë¹„ */
            box-shadow: inset 0 0 10px rgba(0,0,0,0.8), 0 5px 10px rgba(0,0,0,0.5);
            overflow: hidden;
        }
        button {
            padding: 15px 50px;
            font-size: 28px;
            cursor: pointer;
            background-color: #FF0000; /* ê°•ë ¬í•œ ë¹¨ê°„ìƒ‰ SPIN ë²„íŠ¼ */
            color: white;
            border: 5px solid #FFD700; /* ê¸ˆìƒ‰ ë²„íŠ¼ í…Œë‘ë¦¬ */
            border-radius: 50px;
            transition: background-color 0.3s;
            font-weight: bold;
            text-shadow: 1px 1px 2px #000;
        }
        button:hover:not(:disabled) {
            background-color: #cc0000;
            box-shadow: 0 0 20px #FFD700;
        }
        button:disabled {
            background-color: #ffcdd2;
            cursor: not-allowed;
            border: 5px solid #aaa;
        }
        #result {
            margin-top: 30px;
            font-size: 32px;
            font-weight: 900;
            min-height: 30px;
            color: #FFD700; /* ê²°ê³¼ ë©”ì‹œì§€ ê¸ˆìƒ‰ */
            text-shadow: 1px 1px 2px #000;
        }
    </style>
</head>
<body>
    <div class="game-frame"> 
        <h1>í™•ë¥  ìŠ¬ë¡¯ë¨¸ì‹ </h1>
        
        <div class="balance-box">
            ì”ì•¡: <span id="coinBalanceDisplay">100</span> ì½”ì¸ (ë°°íŒ…: 10 ì½”ì¸)
        </div>

        <div class="slot-container">
            <div class="reel" id="reel1">â“</div>
            <div class="reel" id="reel2">â“</div>
            <div class="reel" id="reel3">â“</div>
        </div>

        <button id="spinButton">SPIN</button>

        <div id="result">SPIN ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”!</div>
    </div> 

    <script>
        // JavaScript: ìŠ¬ë¡¯ë¨¸ì‹  ë¡œì§ (ë²„ê·¸ ìˆ˜ì • ë° ì•ˆì •í™” ë²„ì „)
        
        // --- 1. ì„¤ì • ë° ë³€ìˆ˜ ---
        const probabilities = [
            { symbol: 'ğŸ’', weight: 40 }, 
            { symbol: 'ğŸ‹', weight: 30 },
            { symbol: 'ğŸ””', weight: 20 },
            { symbol: 'â­', weight: 7 }, 
            { symbol: '7ï¸âƒ£', weight: 3 }  
        ];
        
        const payouts = {
            'ğŸ’': 10, 'ğŸ‹': 20, 'ğŸ””': 50, 'â­': 100, '7ï¸âƒ£': 500
        };
        
        const partialMatchPayout = 3; 
        const INITIAL_BALANCE = 100; 
        
        let coinBalance; 
        const betAmount = 10;
        const REEL_STOP_INTERVAL = 1000; 
        const SPIN_DURATION = 3000; 
        const STORAGE_KEY = 'slotMachineCoinBalance'; 

        const reelElements = [
            document.getElementById('reel1'),
            document.getElementById('reel2'),
            document.getElementById('reel3')
        ];
        const spinButton = document.getElementById('spinButton');
        const resultDisplay = document.getElementById('result');
        const balanceDisplay = document.getElementById('coinBalanceDisplay');

        // --- 2. ë¡œì»¬ ì €ì¥ì†Œ ë° ì”ì•¡ ê´€ë¦¬ ---

        function saveBalance() {
            localStorage.setItem(STORAGE_KEY, coinBalance.toString());
        }

        function loadBalance() {
            const savedBalance = localStorage.getItem(STORAGE_KEY);
            if (savedBalance === null || isNaN(parseInt(savedBalance)) || parseInt(savedBalance) < 0) {
                coinBalance = INITIAL_BALANCE;
            } else {
                coinBalance = parseInt(savedBalance);
            }
            updateBalanceDisplay();
        }

        function updateBalanceDisplay() {
            balanceDisplay.textContent = coinBalance;
            saveBalance(); 

            if (coinBalance < betAmount) {
                spinButton.disabled = true;
                resultDisplay.textContent = "ì½”ì¸ ë¶€ì¡±! ë‹¤ì‹œ ì‹œì‘í•˜ë ¤ë©´ ìƒˆë¡œê³ ì¹¨í•˜ì„¸ìš”.";
                resultDisplay.style.color = 'red';
            } else {
                spinButton.disabled = false;
            }
        }

        // --- 3. í™•ë¥  ê¸°ë°˜ ì‹¬ë³¼ ì„ íƒ ë¡œì§ ---
        
        function getSymbolByProbability() {
            const totalWeight = probabilities.reduce((sum, item) => sum + item.weight, 0);
            let random = Math.random() * totalWeight;

            for (const item of probabilities) {
                if (random < item.weight) {
                    return item.symbol;
                }
                random -= item.weight;
            }
            return probabilities[probabilities.length - 1].symbol; 
        }
        
        // --- 4. ë¦´ íšŒì „ ëª¨ì…˜ ë¡œì§ ---
        
        function startSpinMotion(reelElement, spinDuration) {
            const allSymbols = probabilities.map(p => p.symbol);
            let startTime = null;

            function animate(timestamp) {
                if (!startTime) startTime = timestamp;
                const elapsed = timestamp - startTime;
                
                if (elapsed < spinDuration) {
                    const randomIndex = Math.floor(Math.random() * allSymbols.length);
                    reelElement.textContent = allSymbols[randomIndex];
                    requestAnimationFrame(animate);
                }
            }
            requestAnimationFrame(animate);
        }

        // --- 5. ê²Œì„ ë¡œì§ ---

        function spinReelAndGetResult(reelElement, finalSymbol, spinDuration) {
            return new Promise(resolve => {
                startSpinMotion(reelElement, spinDuration);
                
                setTimeout(() => {
                    reelElement.textContent = finalSymbol;
                    resolve(finalSymbol);
                }, spinDuration);
            });
        }

        async function spinSlots() {
            if (spinButton.disabled) return;

            coinBalance -= betAmount;
            updateBalanceDisplay();
            spinButton.disabled = true;
            resultDisplay.textContent = "ë¦´ì´ ëŒì•„ê°‘ë‹ˆë‹¤... í–‰ìš´ì„ ë¹Œì–´ìš”!";
            resultDisplay.style.color = '#333';
            
            const finalSymbols = reelElements.map(() => getSymbolByProbability()); 
            const spinPromises = [];
            
            for (let i = 0; i < reelElements.length; i++) {
                const duration = SPIN_DURATION + (i * REEL_STOP_INTERVAL);
                
                spinPromises.push(
                    spinReelAndGetResult(reelElements[i], finalSymbols[i], duration)
                );
            }
            
            const results = await Promise.all(spinPromises);

            checkResult(results);
            updateBalanceDisplay();
        }

        function checkResult(results) {
            if (results.length !== 3) {
                resultDisplay.textContent = "ì¹˜ëª…ì ì¸ ì˜¤ë¥˜ ë°œìƒ: ê²°ê³¼ ê°œìˆ˜ ë¶ˆì¼ì¹˜.";
                resultDisplay.style.color = 'red';
                return;
            }

            const [r1, r2, r3] = results;
            let message = "";
            let winAmount = 0;

            if (r1 === r2 && r2 === r3) {
                const multiplier = payouts[r1];
                winAmount = betAmount * multiplier;
                coinBalance += winAmount;
                
                message = `ğŸ‰ ğŸ’¥ğŸ’¥ JACKPOT! ğŸ’¥ğŸ’¥ ${r1} 3ê°œ ì¼ì¹˜! ${multiplier}ë°° íšë“! (+${winAmount})`;
                resultDisplay.style.color = '#ff9800'; 
            } else if (r1 === r2 || r2 === r3 || r1 === r3) {
                winAmount = betAmount * partialMatchPayout;
                coinBalance += winAmount;

                message = `ğŸ¥³ ë‘ ê°œ ì¼ì¹˜! ë³´ë„ˆìŠ¤ ${partialMatchPayout}ë°° íšë“! (+${winAmount})`;
                resultDisplay.style.color = '#4CAF50'; 
            } else {
                message = `ğŸ˜­ ì•„ì‰½ë„¤ìš”. ë‹¤ì‹œ ë„ì „! (-${betAmount})`;
                resultDisplay.style.color = '#d32f2f'; 
            }
            
            resultDisplay.textContent = message;
        }

        // --- 6. ì´ˆê¸° ì‹¤í–‰ ---
        loadBalance(); 
        spinButton.addEventListener('click', spinSlots);
        
    </script>
    </body>
</html>
